Version 4
SHEET 1 1744 692
WIRE -640 -224 -864 -224
WIRE -432 -224 -640 -224
WIRE -320 -224 -432 -224
WIRE -176 -224 -224 -224
WIRE 32 -224 -176 -224
WIRE -432 -176 -432 -224
WIRE 752 -176 272 -176
WIRE 1040 -176 1040 -208
WIRE 1040 -176 832 -176
WIRE -176 -128 -176 -224
WIRE -864 -96 -864 -224
WIRE 656 -80 272 -80
WIRE 800 -80 736 -80
WIRE 864 -80 800 -80
WIRE 1040 -80 1040 -176
WIRE 1040 -80 944 -80
WIRE -432 -64 -432 -96
WIRE -272 -64 -272 -160
WIRE -272 -64 -432 -64
WIRE -432 -32 -432 -64
WIRE -176 16 -176 -48
WIRE 336 16 272 16
WIRE -640 32 -640 -224
WIRE -640 32 -768 32
WIRE 336 48 336 16
WIRE 1040 48 1040 -80
WIRE -864 64 -864 -16
WIRE -640 80 -640 32
WIRE -432 80 -432 32
WIRE 512 80 512 0
WIRE 688 80 512 80
WIRE 368 128 240 128
WIRE 512 128 512 80
WIRE 512 128 448 128
WIRE 528 128 512 128
WIRE 800 128 800 -80
WIRE 800 128 656 128
WIRE -768 160 -768 32
WIRE 528 160 512 160
WIRE 688 160 688 80
WIRE 688 160 656 160
WIRE 800 160 800 128
WIRE 1040 176 1040 128
WIRE 240 192 240 128
WIRE -640 208 -640 160
WIRE -640 208 -704 208
WIRE 512 256 512 160
WIRE 800 256 800 224
WIRE 800 256 512 256
WIRE -640 288 -640 208
WIRE 800 304 800 256
WIRE -768 336 -768 256
WIRE -704 336 -768 336
WIRE 240 336 240 272
WIRE -768 400 -768 336
WIRE -640 448 -640 384
WIRE 32 448 -640 448
WIRE -768 528 -768 480
WIRE 32 528 -768 528
FLAG 1040 -208 CALC
FLAG -432 80 0
FLAG -864 64 0
FLAG 32 448 CHARGE
FLAG 272 -80 CHARGE
FLAG 336 48 0
FLAG 32 -224 VREG
FLAG 240 336 0
FLAG 272 -176 VREG
FLAG -176 16 0
FLAG 1040 176 0
FLAG 800 304 0
FLAG 32 528 GROUND
FLAG 272 16 GROUND
FLAG 512 0 VBAT
SYMBOL voltage 240 176 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 24 -12 Left 2
SYMATTR InstName V1
SYMATTR Value 3.7
SYMATTR SpiceLine Rser=0.5
SYMBOL res 1024 32 R0
SYMATTR InstName R104
SYMATTR Value 27
SYMBOL voltage -864 -112 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 24
SYMBOL res -448 -192 R0
SYMATTR InstName R2
SYMATTR Value 470
SYMBOL npn -320 -160 R270
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res -784 384 R0
SYMATTR InstName R3
SYMATTR Value 470
SYMBOL res -624 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 13
SYMBOL pnp -704 288 R0
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL pnp -704 256 R180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res 640 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R100
SYMATTR Value {RAC}
SYMBOL zener -416 32 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value DI_MMSZ5231B
SYMATTR Prefix X
SYMBOL res 352 144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R103
SYMATTR Value 0.01
SYMBOL res -192 -144 R0
SYMATTR InstName R105
SYMATTR Value 100K
SYMBOL res 848 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R101
SYMATTR Value {RAC}
SYMBOL res 848 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R102
SYMATTR Value {RDC}
SYMBOL AutoGenerated\\MAX40203 592 144 R0
SYMATTR InstName U1
SYMBOL zener 816 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -160 -4 Left 2
SYMATTR InstName D2
SYMATTR Value DI_MMSZ5231B
SYMATTR Prefix X
TEXT -472 -504 Left 2 !.tran 100m
TEXT -736 -264 Left 2 !.lib mmsz5231.sub
TEXT -472 -472 Left 2 ;.PARAM CHARGER=0
TEXT 208 -232 Left 2 !.PARAM RAC=0.01+(100MEG-100MEG*{CHARGER})
TEXT 656 -256 Right 2 !.PARAM RDC=0.01+(100MEG*{CHARGER})
TEXT -344 -552 Left 3 ;Configuration
TEXT -608 -344 Left 3 ;HP AC Adapter Model
TEXT 32 -544 Left 3 ;Set "CHARGER=1" for AC Adapter usecase\nSet "CHARGER=0" for LiPo usecase
TEXT 968 -352 Left 3 ;Calc. Load
TEXT 184 416 Left 3 ;LiPo 3.7V
TEXT 480 416 Left 3 ;Reverse Current Protection
TEXT -904 -520 Left 3 ;25-NOV-2020\nT. LeMense
TEXT -520 -664 Left 5 ;HP Classic Battery Pack - Reverse Current Protection
TEXT 32 -448 Left 3 ;Observe: V(VBAT,CALC) and I(R103) for both cases\nGoal 1: minimal V(VBAT,CALC) when CHARGER=0\nGoal 2: minimal I(R103) when CHARGER=1
TEXT -696 552 Left 2 ;Note: tweaked R3 to obtain ~50mA of charge current
TEXT -472 -440 Left 2 !.step param CHARGER list 0 1
RECTANGLE Normal -16 576 -912 -320 2
RECTANGLE Normal 1104 224 992 -320 2
RECTANGLE Normal 864 384 480 32 2
RECTANGLE Normal 320 384 176 112 2
RECTANGLE Normal 0 -416 -480 -528 2
CIRCLE Normal -1008 -736 -992 -736 2
CIRCLE Normal -992 -736 -1024 -768 2
CIRCLE Normal 1200 672 1216 672 2
